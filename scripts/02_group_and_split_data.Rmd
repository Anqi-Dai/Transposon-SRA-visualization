---
title: "Group and split the data"
author: "Anqi Dai"
date: "3/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
library(tidyverse)


```

```{r}
# download the data to local first so that I can test
# spent a lot of time finally figuring this out 
# read the test data
Test <- read_csv('../data/testing_TE.csv') %>%
  mutate(localPath = str_replace_all(Path, '/projectnb/lau-bumc/qichengm/projects/Lau_lab/human/HD_PD_project/miRNA/','../data/countData/')) %>%
  mutate(fileContent = map(localPath,  ~ read_tsv(., col_names = F, skip = 1))) %>%
  unnest %>%
  dplyr::select(-X1, -Path) %>%
  rename(bin = X2,  
         Pos1 = X3,
         Neg1 = X4,
         Pos2 = X5,
         Neg2 = X6,
         Pos3 = X7,
         Neg3 = X8)
```

```{r box}
source('02_plot_a_single_boxplot_pair.R')
# the boxplot
TEs <- names(table(Test$TE))
Nums <- seq(1,3)

input_params <- data_frame(
  TE_name = rep(TEs,each = 3),
  Num = rep(Nums, length(TEs))
)

pmap(input_params, function(TE_name, Num){
  DF <- Test
  draw_per_bin_boxpot(TE_name, Num)
})
```

