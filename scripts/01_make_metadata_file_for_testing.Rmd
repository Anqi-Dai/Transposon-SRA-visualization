---
title: "Make metadata file for testing"
author: "Anqi Dai"
date: "3/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
```

```{r}
library(tidyverse)
```

```{r}
# load the table for testing on one TE

res <- list.files(path = '../data/', pattern = "Nelson", full.names = T) %>%
  map( function(fn) 
    read_delim(fn, delim = ' ', col_names = F)  %>%
    dplyr::select(X8) %>%
    separate(X8, into = c('SampleFolder','TE'), sep = '/') %>%
    mutate(Path = str_glue('/projectnb/lau-bumc/qichengm/projects/Lau_lab/human/HD_PD_project/miRNA/{SampleFolder}/{TE}'))  %>%
    mutate(TE = str_replace_all(TE, '^TE@','')) %>%
    mutate(Status = if_else(grepl(pattern = '^C', SampleFolder), 'Control', if_else(grepl(pattern = '^P', SampleFolder), 'Parkinsons','Huntingtons'))) %>%
    mutate(Status = factor(Status))  %>%
    mutate(Sample = str_replace_all(SampleFolder, '_TE$','')) %>%
    dplyr::select(TE, Sample, Status, Path)) %>%
  bind_rows
 
res %>%
  write_csv('../data/testing_TE.csv')


```

